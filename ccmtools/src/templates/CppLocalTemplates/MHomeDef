/*
 * This file was automatically generated by %(CcmToolsVersion)s
 * <http://ccmtools.sourceforge.net/>
 * DO NOT EDIT !
 */

//==============================================================================
// %(Identifier)s - home class and support classes
//==============================================================================

#ifndef __HOME_%(PreprocIdentifier)s_GEN__H__
#define __HOME_%(PreprocIdentifier)s_GEN__H__

#include <string>
#include <map>
#include <WX/Utils/smartptr.h>
#include <ccm/local/Components/CCM.h>
#include <ccm/local/HomeFinder.h>

%(MFactoryDefInclude)s
%(MFinderDefInclude)s
%(MSupportsDefInclude)s
%(BaseInclude)s

#include "%(ComponentType)s_gen.h"

%(OpenNamespace)s

class CCM_%(ComponentType)s;
class %(ComponentType)s;
class CCM_%(Identifier)sExplicit;
class CCM_%(Identifier)sImplicit;
class CCM_%(Identifier)s;
class %(Identifier)s;

//==============================================================================
// explicit support classes
//==============================================================================

class %(Identifier)sExplicit
    : public ::ccm::local::Components::CCMHome
{
  public:
%(MFactoryDefAdapterPrototypeVV)s
};

//==============================================================================
// implicit support classes
//==============================================================================

class %(Identifier)sImplicit
    : public ::ccm::local::Components::KeylessCCMHome
{
  public:
    virtual WX::Utils::SmartPtr<%(ComponentType)s> create()
        throw(::ccm::local::Components::CCMException, 
              ::ccm::local::Components::CreateFailure) = 0;
};




//==============================================================================
// home and home adapter classes
//==============================================================================

class %(Identifier)s
    : public %(Identifier)sExplicit, public %(Identifier)sImplicit%(BaseType)s
{
  protected:
    CCM_%(Identifier)s* local_home;
    WX::Utils::SmartPtr< ::ccm::local::Components::AssemblyFactory> assembly_factory;

  public:
    %(Identifier)s();
    %(Identifier)s(WX::Utils::SmartPtr< ::ccm::local::Components::AssemblyFactory> assembly_factory);	
    virtual ~%(Identifier)s();

%(MFactoryDefAdapterPrototypeV)s

    // CCMHome functions
    virtual WX::Utils::SmartPtr<%(ComponentType)s> create()
        throw(::ccm::local::Components::CCMException, 
              ::ccm::local::Components::CreateFailure);

    virtual void remove_component(
	    WX::Utils::SmartPtr< ::ccm::local::Components::CCMObject> component)
        throw(::ccm::local::Components::CCMException, 
              ::ccm::local::Components::RemoveFailure);

    // KeylessCCMHome functions
    virtual WX::Utils::SmartPtr< ::ccm::local::Components::CCMObject> create_component()
        throw(::ccm::local::Components::CCMException, 
              ::ccm::local::Components::CreateFailure);
};

%(CloseNamespace)s

//==============================================================================
// entry point
//==============================================================================

extern "C" {
    WX::Utils::SmartPtr< ::ccm::local::Components::CCMHome> 
        create_%(AbsoluteLocalHomeName)sAdapter();

    int deploy_%(AbsoluteLocalHomeName)s(char* name);

    int deploy_with_assembly_%(AbsoluteLocalHomeName)s(char* name,	
        WX::Utils::SmartPtr< ::ccm::local::Components::AssemblyFactory> assembly_factory);

    int undeploy_%(AbsoluteLocalHomeName)s(char* name);
}

#endif


<<<<<<<SPLIT>>>>>>>
/*
 * This file was automatically generated by %(CcmToolsVersion)s
 * <http://ccmtools.sourceforge.net/>
 * DO NOT EDIT !
 */

//==============================================================================
// %(Identifier)s - home class component logic implementation
//==============================================================================

#include <cassert>
#include <iostream>
#include <WX/Utils/debug.h>

#include "%(Identifier)s_gen.h"
#include <%(AbsoluteLocalHomeName)s_entry.h>

%(OpenNamespace)s

using namespace std;
using namespace WX::Utils;

//==============================================================================
// home adapter implementation
//==============================================================================

%(Identifier)s::%(Identifier)s()
{
    LDEBUGNL(CCM_CONTAINER,"+%(Identifier)s::%(Identifier)s()");
    local_home = dynamic_cast<CCM_%(Identifier)s*>(create_%(AbsoluteLocalHomeName)s());
    assembly_factory = SmartPtr< ::ccm::local::Components::AssemblyFactory>();
}

%(Identifier)s::%(Identifier)s(SmartPtr< ::ccm::local::Components::AssemblyFactory> f)
    : assembly_factory(f)
{
    LDEBUGNL(CCM_CONTAINER,"+%(Identifier)s::%(Identifier)s(AssemblyFactory)");
    local_home = dynamic_cast<CCM_%(Identifier)s*>(create_%(AbsoluteLocalHomeName)s());
}

%(Identifier)s::~%(Identifier)s()
{
    LDEBUGNL(CCM_CONTAINER,"-%(Identifier)s::~%(Identifier)s()");
    delete local_home;
}

%(MFactoryDefAdapterDefinition)s

// CCMHome functions

SmartPtr<%(ComponentType)s>
%(Identifier)s::create()
    throw(::ccm::local::Components::CCMException, 
          ::ccm::local::Components::CreateFailure)
{
    LDEBUGNL(CCM_CONTAINER," %(Identifier)s::create()");
    SmartPtr< ::ccm::local::Components::Assembly> assembly;
    if(assembly_factory != SmartPtr< ::ccm::local::Components::AssemblyFactory>()) {
        assembly = assembly_factory->create(); 
    }
    SmartPtr<%(ComponentType)s> 
        ret(dynamic_cast<%(ComponentType)s*>(
            new %(ComponentType)s(this, 
            dynamic_cast<CCM_%(ComponentType)s*>(
                ((CCM_%(Identifier)sImplicit*)local_home)->create()),
                assembly
            )
        )
    );
    if(assembly_factory != SmartPtr< ::ccm::local::Components::AssemblyFactory>()) {
        assembly->build(ret);
    }
    return ret;
}

void
%(Identifier)s::remove_component(
    SmartPtr< ::ccm::local::Components::CCMObject> component)
    throw(::ccm::local::Components::CCMException, 
          ::ccm::local::Components::RemoveFailure)
{
    LDEBUGNL(CCM_CONTAINER," %(Identifier)s::remove_component()");
    component->remove();
}

SmartPtr< ::ccm::local::Components::CCMObject>
%(Identifier)s::create_component()
    throw(::ccm::local::Components::CCMException, 
          ::ccm::local::Components::CreateFailure)
{
    LDEBUGNL(CCM_CONTAINER," %(Identifier)s::create_component()");
    return create();
}

%(CloseNamespace)s

//==============================================================================
// entry point
//==============================================================================

extern "C" {

WX::Utils::SmartPtr< ::ccm::local::Components::CCMHome>
create_%(AbsoluteLocalHomeName)sAdapter()
{
    LDEBUGNL(CCM_CONTAINER," create_%(AbsoluteLocalHomeName)sAdapter()");
    WX::Utils::SmartPtr< ::ccm::local::Components::CCMHome>
        ret(new %(LocalNamespace)s::%(Identifier)s());
    return ret;
}

int 
deploy_%(AbsoluteLocalHomeName)s(char* name)
{
    LDEBUGNL(CCM_CONTAINER," deploy_%(AbsoluteLocalHomeName)s()");
    return deploy_with_assembly_%(AbsoluteLocalHomeName)s(
        name, WX::Utils::SmartPtr< ::ccm::local::Components::AssemblyFactory>());	
}	

int 
deploy_with_assembly_%(AbsoluteLocalHomeName)s(char* name,
    WX::Utils::SmartPtr< ::ccm::local::Components::AssemblyFactory> assembly_factory)
{
    LDEBUGNL(CCM_CONTAINER," deploy_with_assembly_%(AbsoluteLocalHomeName)s()");
    try {
        WX::Utils::SmartPtr< ::ccm::local::Components::CCMHome> 
            ret(new %(LocalNamespace)s::%(Identifier)s(assembly_factory));
        ::ccm::local::HomeFinder::Instance()->register_home(ret, name);
    }
    catch (...) {
        return -1;
    }
    return 0; 
}	

int 
undeploy_%(AbsoluteLocalHomeName)s(char* name)
{
    LDEBUGNL(CCM_CONTAINER," undeploy_%(AbsoluteLocalHomeName)s()");
    try {
        ::ccm::local::HomeFinder::Instance()->unregister_home(name);	
    } 
    catch(...) {
        return -1;
    }
    return 0;
}

} // end of extern "C"


<<<<<<<SPLIT>>>>>>>
/*
 * This file was automatically generated by %(CcmToolsVersion)s
 * <http://ccmtools.sourceforge.net/>
 * DO NOT EDIT !
 */

//==============================================================================
// %(Identifier)s - shared class definitions
//==============================================================================

#ifndef __HOME_%(PreprocIdentifier)s_SHARE__H__
#define __HOME_%(PreprocIdentifier)s_SHARE__H__

#include <WX/Utils/smartptr.h>
#include <ccm/local/Components/CCM.h>

%(MFactoryDefInclude)s
%(MFinderDefInclude)s
%(MSupportsDefInclude)s
%(BaseInclude)s

%(OpenNamespace)s

//==============================================================================
// home classes
//==============================================================================

class CCM_%(Identifier)sExplicit
    : public ::ccm::local::Components::HomeExecutorBase
{
  public:
%(MFactoryDefPrototypeVV)s
};


class CCM_%(Identifier)sImplicit
{
  public:
    virtual ::ccm::local::Components::EnterpriseComponent* create()
        throw(::ccm::local::Components::CCMException) = 0;
};


class CCM_%(Identifier)s
    : public CCM_%(Identifier)sExplicit, 
      public CCM_%(Identifier)sImplicit%(BaseType)s%(MSupportsDefBase)s
{
};

%(CloseNamespace)s

#endif // __HOME_%(PreprocIdentifier)s_SHARE__H__


<<<<<<<SPLIT>>>>>>>
/*
 * This file was automatically generated by %(CcmToolsVersion)s
 * <http://ccmtools.sourceforge.net/>
 * DO NOT EDIT !
 */

//==============================================================================
// %(Identifier)s - entry point
//==============================================================================

#ifndef __HOME_%(PreprocIdentifier)s_ENTRY__H__
#define __HOME_%(PreprocIdentifier)s_ENTRY__H__

extern "C" {
    ::ccm::local::Components::HomeExecutorBase* 
        create_%(AbsoluteLocalHomeName)s();
}

#endif // __HOME_%(PreprocIdentifier)s_ENTRY__H__


<<<<<<<SPLIT>>>>>>>
/***
 * This file was automatically generated by %(CcmToolsVersion)s
 * <http://ccmtools.sourceforge.net/>
 *
 * %(Identifier)s home business logic definition.
 * 
 * // TODO: WRITE YOUR DESCRIPTION HERE! 
 *
 * @author
 * @version 
 ***/

#ifndef __HOME_%(PreprocIdentifier)s_IMPL__H__
#define __HOME_%(PreprocIdentifier)s_IMPL__H__

#include <%(HomeInclude)s_share.h>

%(OpenNamespace)s

/**
 * This class implements a component home's attributes and factory methods.
 * CCM_%(Identifier)s home class 
 *
 * // TODO: WRITE YOUR DESCRIPTION HERE! 
 *
 * @author
 * @version 
 **/
class CCM_%(Identifier)s_impl
    : public CCM_%(Identifier)s%(BaseType)s
{
  public:
    CCM_%(Identifier)s_impl();
    virtual ~CCM_%(Identifier)s_impl();

    virtual ::ccm::local::Components::EnterpriseComponent* create()
        throw(::ccm::local::Components::CCMException);

%(MFactoryDefPrototypeV)s
};

%(CloseNamespace)s

#endif


<<<<<<<SPLIT>>>>>>>
/*
 * This file was automatically generated by %(CcmToolsVersion)s
 * <http://ccmtools.sourceforge.net/>
 *
 * %(Identifier)s home business logic implementation.
 * 
 * // TODO: WRITE YOUR DESCRIPTION HERE! 
 *
 * @author
 * @version 
 ***/

#include <cassert>
#include <iostream>
#include <WX/Utils/debug.h>

#include "%(ComponentType)s_impl.h"
#include "%(Identifier)s_impl.h"
#include "%(AbsoluteLocalHomeName)s_entry.h"

%(OpenNamespace)s

using namespace std;
using namespace WX::Utils;

//==============================================================================
// CCM_%(Identifier)s - home implementation 
//==============================================================================

CCM_%(Identifier)s_impl::CCM_%(Identifier)s_impl()
{
    // OPTIONAL : IMPLEMENT ME HERE !
}

CCM_%(Identifier)s_impl::~CCM_%(Identifier)s_impl()
{
    // OPTIONAL : IMPLEMENT ME HERE !
}

::ccm::local::Components::EnterpriseComponent*
CCM_%(Identifier)s_impl::create()
    throw(::ccm::local::Components::CCMException)
{
    return dynamic_cast< ::ccm::local::Components::EnterpriseComponent* >
        (new CCM_%(ComponentType)s_impl());
}

%(MFactoryDefImplDefinition)s

%(CloseNamespace)s


//==============================================================================
// CCM_%(Identifier)s - home entry point
//==============================================================================

extern "C" {
    
::ccm::local::Components::HomeExecutorBase*
create_%(AbsoluteLocalHomeName)s()
{
    return dynamic_cast< ::ccm::local::Components::HomeExecutorBase* >
        (new %(LocalNamespace)s::CCM_%(Identifier)s_impl());
}

} // end of extern "C"


