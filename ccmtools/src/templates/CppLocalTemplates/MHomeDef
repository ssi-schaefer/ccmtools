/*
 * This file was automatically generated by %(CcmToolsVersion)s
 * <http://ccmtools.sourceforge.net/>
 * DO NOT EDIT !
 */

//==============================================================================
// %(Identifier)s - home class and support classes
//==============================================================================

#ifndef __HOME_%(PreprocIdentifier)s_GEN__H__
#define __HOME_%(PreprocIdentifier)s_GEN__H__

#include <string>
#include <map>
#include <WX/Utils/smartptr.h>
#include <ccm/local/Components/CCM.h>
#include <ccm/local/HomeFinder.h>

%(MFactoryDefInclude)s
%(MFinderDefInclude)s
%(MSupportsDefInclude)s
%(BaseInclude)s

#include "%(ComponentType)s_gen.h"

// BEGIN-HACK: Itanium
#include <%(HomeInclude)s_impl.h> 
// END-HACK: Itanium

%(OpenNamespace)s

//==============================================================================
// explicit support classes
//==============================================================================

class %(Identifier)sExplicit
    : virtual public ::ccm::local::Components::CCMHome
{
  public:

    virtual ~%(Identifier)sExplicit() {}

%(MFactoryDefAdapterPrototypeVV)s
};

//==============================================================================
// implicit support classes
//==============================================================================

class %(Identifier)sImplicit
    : virtual public ::ccm::local::Components::KeylessCCMHome
{
  public:
  
    virtual ~%(Identifier)sImplicit() {}
    
    virtual WX::Utils::SmartPtr<%(ComponentType)s> create()
        throw(::ccm::local::Components::CCMException, 
              ::ccm::local::Components::CreateFailure) = 0;
};




//==============================================================================
// home and home adapter classes
//==============================================================================

class %(Identifier)s
    : virtual public %(Identifier)sExplicit, 
      virtual public %(Identifier)sImplicit%(BaseType)s
{
  public:
    %(Identifier)s();
    %(Identifier)s(WX::Utils::SmartPtr< ::ccm::local::Components::AssemblyFactory> assembly_factory);	
    virtual ~%(Identifier)s();

%(MFactoryDefAdapterPrototypeV)s

    // CCMHome functions
    virtual WX::Utils::SmartPtr<%(ComponentType)s> create()
        throw(::ccm::local::Components::CCMException, 
              ::ccm::local::Components::CreateFailure);

    virtual void remove_component(
	    WX::Utils::SmartPtr< ::ccm::local::Components::CCMObject> component)
        throw(::ccm::local::Components::CCMException, 
              ::ccm::local::Components::RemoveFailure);

    // KeylessCCMHome functions
    virtual WX::Utils::SmartPtr< ::ccm::local::Components::CCMObject> create_component()
        throw(::ccm::local::Components::CCMException, 
              ::ccm::local::Components::CreateFailure);

  protected:
    // BEGIN-HACK: Itanium
    CCM_%(Identifier)s_impl* local_home;
    // END-HACK: Itanium 
    WX::Utils::SmartPtr< ::ccm::local::Components::AssemblyFactory> assembly_factory;
    
  private:
    void operator=(const %(Identifier)s&);
};

%(CloseNamespace)s

//==============================================================================
// entry point
//==============================================================================

WX::Utils::SmartPtr< ::ccm::local::Components::CCMHome> 
create_%(AbsoluteLocalHomeName)sAdapter();

int 
deploy_%(AbsoluteLocalHomeName)s(char* name);

int 
deploy_with_assembly_%(AbsoluteLocalHomeName)s(char* name,	
        WX::Utils::SmartPtr< ::ccm::local::Components::AssemblyFactory> assembly_factory);

int undeploy_%(AbsoluteLocalHomeName)s(char* name);

#endif


<<<<<<<SPLIT>>>>>>>
/*
 * This file was automatically generated by %(CcmToolsVersion)s
 * <http://ccmtools.sourceforge.net/>
 * DO NOT EDIT !
 */

//==============================================================================
// %(Identifier)s - home class component logic implementation
//==============================================================================

#include <cassert>
#include <iostream>
#include <WX/Utils/debug.h>

#include "%(Identifier)s_gen.h"
#include <%(AbsoluteLocalHomeName)s_entry.h>

%(OpenNamespace)s

using namespace std;
using namespace WX::Utils;

//==============================================================================
// home adapter implementation
//==============================================================================

%(Identifier)s::%(Identifier)s()
{
    LDEBUGNL(CCM_CONTAINER,"+%(Identifier)s::%(Identifier)s()");
    // BEGIN-HACK: Itanium
    local_home = dynamic_cast<CCM_%(Identifier)s_impl*>(create_%(AbsoluteLocalHomeName)s());
    // END-HACK: Itanium
    assembly_factory = SmartPtr< ::ccm::local::Components::AssemblyFactory>();
}

%(Identifier)s::%(Identifier)s(SmartPtr< ::ccm::local::Components::AssemblyFactory> f)
    : assembly_factory(f)
{
    LDEBUGNL(CCM_CONTAINER,"+%(Identifier)s::%(Identifier)s(AssemblyFactory)");
    // BEGIN-HACK: Itanium
    local_home = dynamic_cast<CCM_%(Identifier)s_impl*>(create_%(AbsoluteLocalHomeName)s());
    // END-HACK: Itanium
}

%(Identifier)s::~%(Identifier)s()
{
    LDEBUGNL(CCM_CONTAINER,"-%(Identifier)s::~%(Identifier)s()");
    delete local_home;
}

%(MFactoryDefAdapterDefinition)s

// CCMHome functions

SmartPtr<%(ComponentType)s>
%(Identifier)s::create()
    throw(::ccm::local::Components::CCMException, 
          ::ccm::local::Components::CreateFailure)
{
    LDEBUGNL(CCM_CONTAINER," %(Identifier)s::create()");
    SmartPtr< ::ccm::local::Components::Assembly> assembly;
    if(assembly_factory != SmartPtr< ::ccm::local::Components::AssemblyFactory>()) {
        assembly = assembly_factory->create(); 
    }
    
    ::ccm::local::Components::EnterpriseComponent* enterprise_component = local_home->create();
    CCM_%(ComponentType)s* local_component = dynamic_cast<CCM_%(ComponentType)s*>(enterprise_component);
    %(ComponentType)s* adapter = new %(ComponentType)s(this, local_component, assembly);
    SmartPtr<%(ComponentType)s> ret(adapter);    
    
    if(assembly_factory != SmartPtr< ::ccm::local::Components::AssemblyFactory>()) {
        assembly->build(ret);
    }
    return ret;
}

void
%(Identifier)s::remove_component(
    SmartPtr< ::ccm::local::Components::CCMObject> component)
    throw(::ccm::local::Components::CCMException, 
          ::ccm::local::Components::RemoveFailure)
{
    LDEBUGNL(CCM_CONTAINER," %(Identifier)s::remove_component()");
    component->remove();
}

SmartPtr< ::ccm::local::Components::CCMObject>
%(Identifier)s::create_component()
    throw(::ccm::local::Components::CCMException, 
          ::ccm::local::Components::CreateFailure)
{
    LDEBUGNL(CCM_CONTAINER," %(Identifier)s::create_component()");
    return create();
}

%(CloseNamespace)s

//==============================================================================
// entry point
//==============================================================================

WX::Utils::SmartPtr< ::ccm::local::Components::CCMHome>
create_%(AbsoluteLocalHomeName)sAdapter()
{
    LDEBUGNL(CCM_CONTAINER," create_%(AbsoluteLocalHomeName)sAdapter()");
    WX::Utils::SmartPtr< ::ccm::local::Components::CCMHome>
        ret(new %(LocalNamespace)s::%(Identifier)s());
    return ret;
}

int 
deploy_%(AbsoluteLocalHomeName)s(char* name)
{
    LDEBUGNL(CCM_CONTAINER," deploy_%(AbsoluteLocalHomeName)s()");
    return deploy_with_assembly_%(AbsoluteLocalHomeName)s(
        name, WX::Utils::SmartPtr< ::ccm::local::Components::AssemblyFactory>());	
}	

int 
deploy_with_assembly_%(AbsoluteLocalHomeName)s(char* name,
    WX::Utils::SmartPtr< ::ccm::local::Components::AssemblyFactory> assembly_factory)
{
    LDEBUGNL(CCM_CONTAINER," deploy_with_assembly_%(AbsoluteLocalHomeName)s()");
    try {
        WX::Utils::SmartPtr< ::ccm::local::Components::CCMHome> 
            ret(new %(LocalNamespace)s::%(Identifier)s(assembly_factory));
        ::ccm::local::HomeFinder::Instance()->register_home(ret, name);
    }
    catch (...) {
        return -1;
    }
    return 0; 
}	

int 
undeploy_%(AbsoluteLocalHomeName)s(char* name)
{
    LDEBUGNL(CCM_CONTAINER," undeploy_%(AbsoluteLocalHomeName)s()");
    try {
        ::ccm::local::HomeFinder::Instance()->unregister_home(name);	
    } 
    catch(...) {
        return -1;
    }
    return 0;
}



<<<<<<<SPLIT>>>>>>>
/*
 * This file was automatically generated by %(CcmToolsVersion)s
 * <http://ccmtools.sourceforge.net/>
 * DO NOT EDIT !
 */

//==============================================================================
// %(Identifier)s - shared class definitions
//==============================================================================

#ifndef __HOME_%(PreprocIdentifier)s_SHARE__H__
#define __HOME_%(PreprocIdentifier)s_SHARE__H__

#include <WX/Utils/smartptr.h>
#include <ccm/local/Components/CCM.h>

%(MFactoryDefInclude)s
%(MFinderDefInclude)s
%(MSupportsDefInclude)s
%(BaseInclude)s

%(OpenNamespace)s

//==============================================================================
// home classes
//==============================================================================

class CCM_%(Identifier)sExplicit
    : virtual public ::ccm::local::Components::HomeExecutorBase
{
  public:
  
    virtual ~CCM_%(Identifier)sExplicit() {}
    
%(MFactoryDefPrototypeVV)s
};


class CCM_%(Identifier)sImplicit
{
  public:
  
    virtual ~CCM_%(Identifier)sImplicit() {}  
  
    virtual ::ccm::local::Components::EnterpriseComponent* create()
        throw(::ccm::local::Components::CCMException) = 0;
};


class CCM_%(Identifier)s
    : virtual public CCM_%(Identifier)sExplicit, 
      virtual public CCM_%(Identifier)sImplicit%(BaseType)s%(MSupportsDefBase)s
{
  public:
    virtual ~CCM_%(Identifier)s() {}
};

%(CloseNamespace)s

#endif // __HOME_%(PreprocIdentifier)s_SHARE__H__


<<<<<<<SPLIT>>>>>>>
/*
 * This file was automatically generated by %(CcmToolsVersion)s
 * <http://ccmtools.sourceforge.net/>
 * DO NOT EDIT !
 */

//==============================================================================
// %(Identifier)s - entry point
//==============================================================================

#ifndef __HOME_%(PreprocIdentifier)s_ENTRY__H__
#define __HOME_%(PreprocIdentifier)s_ENTRY__H__

::ccm::local::Components::HomeExecutorBase* 
create_%(AbsoluteLocalHomeName)s();

#endif // __HOME_%(PreprocIdentifier)s_ENTRY__H__


<<<<<<<SPLIT>>>>>>>
/***
 * This file was automatically generated by %(CcmToolsVersion)s
 * <http://ccmtools.sourceforge.net/>
 *
 * %(Identifier)s home business logic definition.
 * 
 * // TODO: WRITE YOUR DESCRIPTION HERE! 
 *
 * @author
 * @version 
 ***/

#ifndef __HOME_%(PreprocIdentifier)s_IMPL__H__
#define __HOME_%(PreprocIdentifier)s_IMPL__H__

#include <%(HomeInclude)s_share.h>

%(OpenNamespace)s

/**
 * This class implements a component home's attributes and factory methods.
 * CCM_%(Identifier)s home class 
 *
 * // TODO: WRITE YOUR DESCRIPTION HERE! 
 *
 * @author
 * @version 
 **/
class CCM_%(Identifier)s_impl
    : virtual public CCM_%(Identifier)s%(BaseType)s
{
  public:
    CCM_%(Identifier)s_impl();
    virtual ~CCM_%(Identifier)s_impl();

    virtual ::ccm::local::Components::EnterpriseComponent* create()
        throw(::ccm::local::Components::CCMException);

%(MFactoryDefPrototypeV)s
};

%(CloseNamespace)s

#endif


<<<<<<<SPLIT>>>>>>>
/*
 * This file was automatically generated by %(CcmToolsVersion)s
 * <http://ccmtools.sourceforge.net/>
 *
 * %(Identifier)s home business logic implementation.
 * 
 * // TODO: WRITE YOUR DESCRIPTION HERE! 
 *
 * @author
 * @version 
 ***/

#include <cassert>
#include <iostream>
#include <WX/Utils/debug.h>

#include "%(ComponentType)s_impl.h"
#include "%(Identifier)s_impl.h"
#include "%(AbsoluteLocalHomeName)s_entry.h"

%(OpenNamespace)s

using namespace std;
using namespace WX::Utils;

//==============================================================================
// CCM_%(Identifier)s - home implementation 
//==============================================================================

CCM_%(Identifier)s_impl::CCM_%(Identifier)s_impl()
{
    // OPTIONAL : IMPLEMENT ME HERE !
}

CCM_%(Identifier)s_impl::~CCM_%(Identifier)s_impl()
{
    // OPTIONAL : IMPLEMENT ME HERE !
}

::ccm::local::Components::EnterpriseComponent*
CCM_%(Identifier)s_impl::create()
    throw(::ccm::local::Components::CCMException)
{
    return dynamic_cast< ::ccm::local::Components::EnterpriseComponent* >
        (new CCM_%(ComponentType)s_impl());
}

%(MFactoryDefImplDefinition)s

%(CloseNamespace)s


//==============================================================================
// CCM_%(Identifier)s - home entry point
//==============================================================================

::ccm::local::Components::HomeExecutorBase*
create_%(AbsoluteLocalHomeName)s()
{
    return dynamic_cast< ::ccm::local::Components::HomeExecutorBase* >
        (new %(LocalNamespace)s::CCM_%(Identifier)s_impl());
}



