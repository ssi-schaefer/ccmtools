::Components::Cookie
%(ComponentType)s::connect_%(Identifier)s(%(UsesType)s::SmartPtr f)
    throw(::Components::ExceededConnectionLimit, ::Components::InvalidConnection)
{
    if(!ValidConnection) 
    {
        throw ::Components::InvalidConnection();
    }
    stringstream s;
    s << "CCM_%(Identifier)s:" << %(Identifier)s_receptacle_counter++;
    ::Components::Cookie ck(s.str());
    %(CCMUsesType)s::SmartPtr ccmf(dynamic_cast< %(CCMUsesType)s* >(f.ptr()));
    %(Identifier)s_receptacles.insert(make_pair(ck, ccmf));
    return ck;
}

%(UsesType)s::SmartPtr
%(ComponentType)s::disconnect_%(Identifier)s(::Components::Cookie ck)
    throw(::Components::InvalidConnection)
{
    if(!ValidConnection) 
    {
        throw ::Components::InvalidConnection();
    }
    if(%(Identifier)s_receptacles.find(ck) != %(Identifier)s_receptacles.end()) 
    {
        %(CCMUsesType)s::SmartPtr f(%(Identifier)s_receptacles[ck]);
        %(Identifier)s_receptacles.erase(ck);
        return f;
    } 
    else 
    {
        throw ::Components::InvalidConnection();
    }
}

%(MultipleReceptacleName)s&
%(ComponentType)s::get_connections_%(Identifier)s (  )
{
    if(!ValidConnection) 
    {
        throw ::Components::InvalidConnection();
    }
    return %(Identifier)s_receptacles;
}


