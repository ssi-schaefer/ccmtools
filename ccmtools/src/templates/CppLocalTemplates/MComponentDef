/*
 * This file was automatically generated by %(CcmToolsVersion)s 
 * <http://ccmtools.sourceforge.net>
 * DO NOT EDIT! 
 */

//==============================================================================
// %(Identifier)s - component logic
//==============================================================================

#ifndef __COMPONENT_%(PreprocIdentifier)s_GEN__H__
#define __COMPONENT_%(PreprocIdentifier)s_GEN__H__

#include <string>
#include <map>
#include <WX/Utils/smartptr.h>
#include <LocalComponents/CCM.h>

#include <%(SelfInclude)s_share.h>
#include <%(HomeInclude)s_share.h>

%(MAttributeDefInclude)s
%(MConstantDefInclude)s
%(MSupportsDefInclude)s
%(MProvidesDefInclude)s
%(MConsumesDefInclude)s
%(MEmitsDefInclude)s
%(MPublishesDefInclude)s
%(MUsesDefInclude)s
%(BaseInclude)s

%(OpenNamespace)s

class %(HomeType)s;
class CCM_%(HomeType)s;
class CCM_%(Identifier)s_Context;

//==============================================================================
// %(Identifier)s local component adapter class
//==============================================================================

class %(Identifier)s
    : virtual public LocalComponents::CCMObject 
      %(MSupportsDefBase)s
      %(BaseType)s 	
{
  protected:
    %(HomeType)s* home_local_adapter;
    CCM_%(Identifier)s* local_component;
    CCM_%(Identifier)s_Context* context;
    WX::Utils::SmartPtr<LocalComponents::Assembly> assembly;
    bool ValidConnection;

%(MProvidesDefAdapterVariable)s
%(MUsesDefAdapterVariable)s

  public:
    %(Identifier)s();
    %(Identifier)s(%(HomeType)s* h, 
                   CCM_%(Identifier)s* lc,  
                   WX::Utils::SmartPtr<LocalComponents::Assembly> a);
    virtual ~%(Identifier)s();

%(MAttributeDefPrototype)s
%(MProvidesDefProvidePrototype)s
%(MUsesDefConnectPrototype)s
%(MUsesDefGetConnectionPrototype)s
%(MSupportsDefAdapterPrototype)s

    // Navigation functions
    WX::Utils::SmartPtr<LocalComponents::Object> provide_facet(const std::string& name)
        throw(LocalComponents::InvalidName);

    // Receptacle functions
    LocalComponents::Cookie connect(const LocalComponents::FeatureName& name, 
                      WX::Utils::SmartPtr<LocalComponents::Object> connection)
        throw(LocalComponents::InvalidName, 
              LocalComponents::InvalidConnection,
              LocalComponents::AlreadyConnected, 
              LocalComponents::ExceededConnectionLimit);

    void disconnect(const LocalComponents::FeatureName& name, 
                    const LocalComponents::Cookie& ck)
        throw(LocalComponents::InvalidName, 
              LocalComponents::InvalidConnection,
              LocalComponents::CookieRequired, 
              LocalComponents::NoConnection );

    // CCMObject functions
    LocalComponents::HomeExecutorBase* get_ccm_home();

    void configuration_complete()
        throw(LocalComponents::InvalidConfiguration);

    void configuration_complete(CCM_%(Identifier)s_Context* ctx)
        throw(LocalComponents::InvalidConfiguration);

    void remove()
        throw(LocalComponents::RemoveFailure);
};


//==============================================================================
// context adapter class
//==============================================================================

class CCM_%(Identifier)s_Context_impl
    : public CCM_%(Identifier)s_Context
{
  private:
    %(Identifier)s* component_local_adapter;

  public:
    CCM_%(Identifier)s_Context_impl(%(Identifier)s* c);
    virtual ~CCM_%(Identifier)s_Context_impl();

%(MUsesDefGetCtxConnectionPrototype)s

    // CCMContext function
    LocalComponents::HomeExecutorBase* get_CCM_home();

    // SessionContext function	
    LocalComponents::Object* get_CCM_object()
        throw(LocalComponents::IllegalState);
};

%(MProvidesDefAdapterClass)s

%(CloseNamespace)s

#endif


<<<<<<<SPLIT>>>>>>>
/*
 * This file was automatically generated by %(CcmToolsVersion)s
 * <http://ccmtools.sourceforge.net/>
 * DO NOT EDIT !
 */

//==============================================================================
// %(Identifier)s - component logic implementation
//==============================================================================

#include <cassert>
#include <iostream>
#include <sstream>
#include <WX/Utils/debug.h>

#ifdef HAVE_CONFIG_H
#include <config.h>
#endif

#ifdef WXDEBUG
#include <CCM_Local/Debug.h>
#endif // WXDEBUG

#include "%(Identifier)s_gen.h"

using namespace std;
using namespace WX::Utils;
using namespace CCM_Local;

%(OpenNamespace)s

%(MProvidesDefAdapterClassImpl)s

//==============================================================================
// context adapter class implementation
//==============================================================================

CCM_%(Identifier)s_Context_impl::CCM_%(Identifier)s_Context_impl(%(Identifier)s* c)
    : component_local_adapter(c)
{
    LDEBUGNL(CCM_CONTAINER,"+CCM_%(Identifier)s_Context_impl::CCM_%(Identifier)s_Context_impl()");
}

CCM_%(Identifier)s_Context_impl::~CCM_%(Identifier)s_Context_impl()
{
    LDEBUGNL(CCM_CONTAINER,"-CCM_%(Identifier)s_Context_impl::~CCM_%(Identifier)s_Context_impl()");
}

%(MUsesDefGetConnectionCtxImplDefinition)s

LocalComponents::HomeExecutorBase*
CCM_%(Identifier)s_Context_impl::get_CCM_home()
{
    LDEBUGNL(CCM_CONTAINER," CCM_%(Identifier)s_Context_impl::get_CCM_home()");
    throw LocalComponents::NotImplemented();
}

LocalComponents::Object*
CCM_%(Identifier)s_Context_impl::get_CCM_object()
    throw(LocalComponents::IllegalState)
{
    LDEBUGNL(CCM_CONTAINER," CCM_%(Identifier)s_Context_impl::get_CCM_object()");
    throw LocalComponents::NotImplemented();
}


//==============================================================================
// local component adapter implementation
//==============================================================================

%(Identifier)s::%(Identifier)s()
{
    LDEBUGNL(CCM_CONTAINER,"+%(Identifier)s::%(Identifier)s()");
    home_local_adapter = NULL;
    local_component = NULL;
    context = NULL;
    assembly = SmartPtr<LocalComponents::Assembly>();	
    ValidConnection = false;
%(MProvidesDefAdapterVariableInitDefault)s
%(MUsesDefAdapterVariableInitDefault)s
}

%(Identifier)s::%(Identifier)s(%(HomeType)s* h, 
    CCM_%(Identifier)s* lc,
    SmartPtr<LocalComponents::Assembly> a)
    : home_local_adapter(h), local_component(lc), assembly(a)
{
    LDEBUGNL(CCM_CONTAINER,"+%(Identifier)s::%(Identifier)s()");
    context = NULL; 
    ValidConnection = true;
%(MProvidesDefAdapterVariableInit)s
%(MUsesDefAdapterVariableInit)s
}

%(Identifier)s::~%(Identifier)s()
{
    LDEBUGNL(CCM_CONTAINER,"-%(Identifier)s::~%(Identifier)s()");
    delete context;
    delete local_component;
}

%(MAttributeDefAdapterDefinition)s
%(MProvidesDefAdapterDefinition)s
%(MUsesDefAdapterDefinition)s
%(MSupportsDefAdapterImplDefinition)s

// Navigation functions

WX::Utils::SmartPtr<LocalComponents::Object>
%(Identifier)s::provide_facet(const std::string& name)
    throw(LocalComponents::InvalidName)
{
    LDEBUGNL(CCM_CONTAINER," %(Identifier)s::provide_facet(" << name << " )");
%(MProvidesDefProvideFacet)s
    throw LocalComponents::InvalidName();
}


// Receptacle functions

LocalComponents::Cookie
%(Identifier)s::connect(const LocalComponents::FeatureName& name, 
                        WX::Utils::SmartPtr<LocalComponents::Object> connection)
    throw(LocalComponents::InvalidName, 
          LocalComponents::InvalidConnection,
          LocalComponents::AlreadyConnected, 
          LocalComponents::ExceededConnectionLimit)
{
    LDEBUGNL(CCM_CONTAINER," %(Identifier)s::connect ( " << name << " )");
%(MUsesDefConnectFacet)s
    throw LocalComponents::InvalidName();
}

void
%(Identifier)s::disconnect(const LocalComponents::FeatureName& name, 
                           const LocalComponents::Cookie& ck)
    throw(LocalComponents::InvalidName, 
          LocalComponents::InvalidConnection,
          LocalComponents::CookieRequired, 
          LocalComponents::NoConnection )
{
    LDEBUGNL(CCM_CONTAINER," %(Identifier)s::disconnect ( " << name << " )");
    if(!ValidConnection) 
        throw LocalComponents::InvalidConnection();

%(MUsesDefDisconnectFacet)s
    throw LocalComponents::InvalidName();
}


// CCMObject functions

LocalComponents::HomeExecutorBase*
%(Identifier)s::get_ccm_home (  )
{
    LDEBUGNL(CCM_CONTAINER," %(Identifier)s::get_ccm_home()");
    throw LocalComponents::NotImplemented();
}


void
%(Identifier)s::configuration_complete()
    throw(LocalComponents::InvalidConfiguration)
{
    LDEBUGNL(CCM_CONTAINER," %(Identifier)s::configuration_complete()");
    configuration_complete(new CCM_%(Identifier)s_Context_impl(this));
}


void
%(Identifier)s::configuration_complete(CCM_%(Identifier)s_Context* ctx)
    throw(LocalComponents::InvalidConfiguration)
{
    LDEBUGNL(CCM_CONTAINER," %(Identifier)s::configuration_complete()");
    if(!ValidConnection) 
        throw LocalComponents::InvalidConnection();
    if(!context)
      context = ctx;
    if(assembly != WX::Utils::SmartPtr<LocalComponents::Assembly>()) { 
        assembly->configuration_complete(); 
    }
    local_component->set_session_context(context);
    local_component->ccm_activate();
}


void
%(Identifier)s::remove()
    throw(LocalComponents::RemoveFailure)
{
    LDEBUGNL(CCM_CONTAINER," %(Identifier)s::remove()");
    if(!ValidConnection) 
        throw LocalComponents::InvalidConnection();
    local_component->ccm_remove();
%(MProvidesDefImplRemove)s

    if(assembly != WX::Utils::SmartPtr<LocalComponents::Assembly>()) { 
        assembly->tear_down(); 
        // To resolve a cyclic smart pointer reference between a component
        // and an assembly object, the assembly smart pointer must be cleaned.
        assembly = WX::Utils::SmartPtr<LocalComponents::Assembly>();
    }
    ValidConnection = false;
}

%(CloseNamespace)s


<<<<<<<SPLIT>>>>>>>
/*
 * This file was automatically generated by %(CcmToolsVersion)s
 * <http://ccmtools.sourceforge.net/>
 * DO NOT EDIT !
 */

//==============================================================================
// %(Identifier)s - shared class definitions
//==============================================================================

#ifndef __COMPONENT_%(PreprocIdentifier)s_SHARE__H__
#define __COMPONENT_%(PreprocIdentifier)s_SHARE__H__

#include <map>
#include <WX/Utils/smartptr.h>
#include <LocalComponents/CCM.h>

%(MAttributeDefInclude)s
%(MConstantDefInclude)s
%(MSupportsDefInclude)s
%(MProvidesDefInclude)s
%(MConsumesDefInclude)s
%(MEmitsDefInclude)s
%(MPublishesDefInclude)s
%(BaseInclude)s
%(MUsesDefInclude)s

%(OpenNamespace)s

//==============================================================================
// Component class
//==============================================================================

class CCM_%(Identifier)s
    : public LocalComponents::SessionComponent%(BaseType)s%(MSupportsDefBase)s
{
  public:
%(MAttributeDefPrototypeVV)s
%(MProvidesDefGetFacetPrototypeVV)s
%(MSupportsDefImplPrototypeVV)s
};


//==============================================================================
// Context class
//==============================================================================

%(MUsesDefConnectionMap)s

class CCM_%(Identifier)s_Context
    : public LocalComponents::SessionContext
{
  public:
%(MUsesDefGetConnectionPrototypeVV)s
};

%(CloseNamespace)s

#endif // __COMPONENT_%(PreprocIdentifier)s_SHARE__H__


<<<<<<<SPLIT>>>>>>>
/***
 * This file was automatically generated by %(CcmToolsVersion)s
 * <http://ccmtools.sourceforge.net/>
 *
 * %(Identifier)s component business logic definition.
 * 
 * // TODO: WRITE YOUR DESCRIPTION HERE! 
 *
 * @author
 * @version 
 ***/

#ifndef __COMPONENT_%(PreprocIdentifier)s_IMPL__H__
#define __COMPONENT_%(PreprocIdentifier)s_IMPL__H__

#include <%(SelfInclude)s_share.h>

%(OpenNamespace)s

/**
 * This class implements a component's equivalent and supported interfaces
 * as well as component attributes. Additionally, session component callback 
 * methods must be implemented.  
 *
 * %(Identifier)s component class 
 *
 * // TODO: WRITE YOUR DESCRIPTION HERE! 
 *
 * @author
 * @version 
 **/
class CCM_%(Identifier)s_impl
    : virtual public CCM_%(Identifier)s%(BaseType)s
{
  private:
%(MAttributeDefVariable)s
%(MSupportsDefVariable)s

  public:
    CCM_%(Identifier)s_Context* ctx;

    CCM_%(Identifier)s_impl();
    virtual ~CCM_%(Identifier)s_impl();

%(MAttributeDefPrototype)s
%(MProvidesDefGetFacetPrototype)s
%(MSupportsDefImplPrototype)s

    // CCM callback methods
    virtual void set_session_context(LocalComponents::SessionContext* ctx)
        throw(LocalComponents::CCMException);
    virtual void ccm_activate()
        throw(LocalComponents::CCMException);
    virtual void ccm_passivate()
        throw(LocalComponents::CCMException);
    virtual void ccm_remove()
        throw(LocalComponents::CCMException);
};

%(CloseNamespace)s

#endif


<<<<<<<SPLIT>>>>>>>
/***
 * This file was automatically generated by %(CcmToolsVersion)s
 * <http://ccmtools.sourceforge.net/>
 *
 * %(Identifier)s component business logic implementation.
 * 
 * // TODO: WRITE YOUR DESCRIPTION HERE! 
 *
 * @author
 * @version 
 ***/

#include <cassert>
#include <iostream>
#include <WX/Utils/debug.h>

#include "%(Identifier)s_impl.h"
%(MProvidesDefImplInclude)s

using namespace std;
using namespace WX::Utils;
using namespace CCM_Local;

%(OpenNamespace)s

//==============================================================================
// CCM_%(Identifier)s - component implementation
//==============================================================================

CCM_%(Identifier)s_impl::CCM_%(Identifier)s_impl()
{
    // OPTIONAL : IMPLEMENT ME HERE !
}

CCM_%(Identifier)s_impl::~CCM_%(Identifier)s_impl()
{
    // OPTIONAL : IMPLEMENT ME HERE !
}

%(MAttributeDefImplDefinition)s
%(MSupportsDefImplDefinition)s

void
CCM_%(Identifier)s_impl::set_session_context(
    LocalComponents::SessionContext* context)
    throw(LocalComponents::CCMException)
{
    ctx = dynamic_cast<CCM_%(Identifier)s_Context*>(context);
}

void
CCM_%(Identifier)s_impl::ccm_activate()
    throw(LocalComponents::CCMException)
{
    // OPTIONAL : IMPLEMENT ME HERE !
}

void
CCM_%(Identifier)s_impl::ccm_passivate()
    throw(LocalComponents::CCMException)
{
    // OPTIONAL : IMPLEMENT ME HERE !
}

void
CCM_%(Identifier)s_impl::ccm_remove()
    throw(LocalComponents::CCMException)
{
    // OPTIONAL : IMPLEMENT ME HERE !
}

%(MProvidesDefGetFacetDefinition)s

%(CloseNamespace)s



