<%@ jet package="ccmtools.generator.java.templates" 
	    class="HomeDefAdapterFromCorbaTemplate" 
		imports="ccmtools.generator.java.metamodel.* "	    
%>
<% HomeDef home = (HomeDef) argument; %>
/*
 * This file was automatically generated by <%=home.generateCcmtoolsVersion()%>
 * <http://ccmtools.sourceforge.net>
 * DO NOT EDIT!
 */

package <%=home.generateJavaRemoteNamespace()%>;

import java.util.logging.Logger;

import ccm.local.ServiceLocator;
import ccm.remote.CCMSessionContainer;

import org.omg.PortableServer.Servant;

<%=home.generateJavaImportStatements(home.generateJavaRemoteNamespace())%>
           
public class <%=home.getIdentifier()%>AdapterFromCorba
   extends <%=home.generateAbsoluteIdlName()%>POA
{
    /** Default logger instance */
    private Logger logger = ServiceLocator.instance().getLogger();

    /** CCM session container instance */
    private CCMSessionContainer container;

    /** Java reference to the local interface */
    private <%=home.getIdentifier()%> localHome;
    
    
    public <%=home.getIdentifier()%>AdapterFromCorba(CCMSessionContainer container, 
        <%=home.getIdentifier()%> localHome)
    {
        logger.fine("localHome = " + localHome);
        this.container = container;
        this.localHome = localHome;
    }
    
       
    /** Home implicit operations */

    public <%=home.getComponent().generateAbsoluteIdlName()%> create () 
        throws Components.CreateFailure
    {
        logger.fine("");
        try
        {
            <%=home.getComponent().getIdentifier()%> localComponent = localHome.create();
            Servant servant = 
                new <%=home.getComponent().getIdentifier()%>AdapterFromCorba(container,localComponent);
            Components.CCMObject obj = 
                container.getCorbaComponentFromServant(servant); 
            return <%=home.getComponent().generateAbsoluteIdlName()%>Helper.narrow(obj);
        }
        catch(Exception e)
        {
            e.printStackTrace();
            throw new Components.CreateFailure();
        }
    }

    /** 
     * This operation is defined in the Components::KeylessCCMHome interface
     */
    public Components.CCMObject create_component()
        throws Components.CreateFailure
    {
        logger.fine("");
        return create();
    }


    /** Home explicit operations */
    
    /**
     * This operation is defined in the Components::CCMHome interface
     */ 
    public void remove_component(Components.CCMObject component)
        throws Components.RemoveFailure
    {
        logger.fine("");
        if(component == null)
        {
            throw new Components.RemoveFailure("Can't remove component because its reference is null!");
        }
        else
        {
            component.remove();
        }
    }
}